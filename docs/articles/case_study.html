<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>NHANES case study • table.glue</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="NHANES case study">
<meta property="og:description" content="table.glue">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">table.glue</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/case_study.html">NHANES case study</a>
    </li>
    <li>
      <a href="../articles/default_rounder.html">Setting a default rounding specification</a>
    </li>
    <li>
      <a href="../articles/table_guide.html">Guide to table making</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bcjaeger/table.glue/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="case_study_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>NHANES case study</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bcjaeger/table.glue/blob/master/vignettes/case_study.Rmd"><code>vignettes/case_study.Rmd</code></a></small>
      <div class="hidden name"><code>case_study.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit">

<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bcjaeger/table.glue">table.glue</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/">tibble</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/rstudio/gt">gt</a></span>, warn.conflicts <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></pre></div>
<div id="overview" class="section level1">
<h1 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h1>
<p>This vignette shows how to go from data to table using <code>table.glue</code> and friends. For this vignette, we will analyze data from The US National Health and Nutrition Examination Survey (NHANES), 2013-2018.</p>
<p>NHANES was designed to assess the health and nutritional status of the non-institutionalized US population and was conducted by the National Center for Health Statistics of the Centers for Disease Control and Prevention. Since 1999-2000, NHANES has been conducted in two-year cycles using a multistage probability sampling design to select participants. Each cycle is independent with different participants recruited.</p>
</div>
<div id="nhanes-blood-pressure-measurements" class="section level1">
<h1 class="hasAnchor">
<a href="#nhanes-blood-pressure-measurements" class="anchor"></a>NHANES Blood pressure measurements</h1>
<p>The same protocol was followed to measure systolic and diastolic blood pressure (SBP and DBP) in each NHANES cycle. After survey participants had rested 5 minutes, their BP was measured by a trained physician using a mercury sphygmomanometer and an appropriately sized cuff. Three BP measurements were obtained at 30 second intervals.</p>
<div class="sourceCode" id="cb2"><pre class="downlit">

<span class="co"># see ?table.glue::nhanes for description of all columns</span>

<span class="fu"><a href="https://tibble.tidyverse.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">nhanes</span><span class="op">)</span>
<span class="co">#&gt; Rows: 29,400</span>
<span class="co">#&gt; Columns: 17</span>
<span class="co">#&gt; $ exam           &lt;chr&gt; "exam_2013_2014", "exam_2013_2014", "exam_2013_2014"...</span>
<span class="co">#&gt; $ seqn           &lt;dbl&gt; 73557, 73558, 73559, 73560, 73561, 73562, 73563, 735...</span>
<span class="co">#&gt; $ psu            &lt;dbl&gt; 1, 1, 1, 2, 2, 1, 1, 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 2...</span>
<span class="co">#&gt; $ strata         &lt;dbl&gt; 112, 108, 109, 109, 116, 111, 105, 114, 106, 112, 11...</span>
<span class="co">#&gt; $ wts_mec_2yr    &lt;dbl&gt; 13481.042, 24471.770, 57193.285, 55766.512, 65541.87...</span>
<span class="co">#&gt; $ exam_status    &lt;chr&gt; "interview and exam", "interview and exam", "intervi...</span>
<span class="co">#&gt; $ age            &lt;dbl&gt; 69, 54, 72, 9, 73, 56, 0, 61, 42, 56, 65, 26, 0, 9, ...</span>
<span class="co">#&gt; $ sex            &lt;chr&gt; "male", "male", "male", "male", "female", "male", "m...</span>
<span class="co">#&gt; $ race_ethnicity &lt;chr&gt; "black", "white", "white", "white", "white", "hispan...</span>
<span class="co">#&gt; $ education      &lt;fct&gt; highschool_or_some_college, highschool_or_some_colle...</span>
<span class="co">#&gt; $ pregnant       &lt;chr&gt; "no", "no", "no", "no", NA, "no", "no", NA, "no", NA...</span>
<span class="co">#&gt; $ bp_sys_mmhg    &lt;dbl&gt; 112.66667, 157.33333, 142.00000, 104.66667, 137.3333...</span>
<span class="co">#&gt; $ bp_dia_mmhg    &lt;dbl&gt; 74.00000, 61.33333, 82.00000, 36.66667, 86.66667, 82...</span>
<span class="co">#&gt; $ n_msr_sbp      &lt;int&gt; 3, 3, 3, 3, 3, 3, 0, 3, NA, 3, 3, 3, NA, 3, 3, 3, 3,...</span>
<span class="co">#&gt; $ n_msr_dbp      &lt;int&gt; 3, 3, 3, 3, 3, 3, 0, 3, NA, 3, 3, 3, NA, 3, 3, 3, 3,...</span>
<span class="co">#&gt; $ bp_high_aware  &lt;chr&gt; "yes", "yes", "yes", NA, "yes", "yes", NA, "yes", "n...</span>
<span class="co">#&gt; $ meds_bp        &lt;chr&gt; "no", "no", "yes", NA, "yes", "yes", NA, "no", "no",...</span></pre></div>
</div>
<div id="making-the-analysis-data" class="section level1">
<h1 class="hasAnchor">
<a href="#making-the-analysis-data" class="anchor"></a>Making the analysis data</h1>
<p>We will make a table showing SBP and DBP for subgroups based on sex and race over the three NHANES cycles in <code>nhanes</code>. But first need to filter to include rows where the survey participant</p>
<ul>
<li><p>completed both the NHANES interview and exam</p></li>
<li><p>is 20 years or older</p></li>
<li><p>is not pregnant</p></li>
<li><p>is currently using medication to lower their BP</p></li>
<li><p>does not have missing data for SBP or DBP</p></li>
</ul>
<div class="sourceCode" id="cb3"><pre class="downlit">

<span class="va">nhanes_analysis</span> <span class="op">&lt;-</span> <span class="va">nhanes</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">exam_status</span> <span class="op">==</span> <span class="st">'interview and exam'</span>, 
         <span class="va">age</span> <span class="op">&gt;=</span> <span class="fl">20</span>, 
         <span class="va">pregnant</span> <span class="op">==</span> <span class="st">'no'</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">pregnant</span><span class="op">)</span>,
         <span class="va">meds_bp</span> <span class="op">==</span> <span class="st">'yes'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">exam</span>, <span class="va">sex</span>, <span class="va">race_ethnicity</span>, <span class="va">bp_sys_mmhg</span>, <span class="va">bp_dia_mmhg</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">nhanes_analysis</span>
<span class="co">#&gt; # A tibble: 4,412 x 5</span>
<span class="co">#&gt;    exam           sex    race_ethnicity bp_sys_mmhg bp_dia_mmhg</span>
<span class="co">#&gt;    &lt;chr&gt;          &lt;chr&gt;  &lt;chr&gt;                &lt;dbl&gt;       &lt;dbl&gt;</span>
<span class="co">#&gt;  1 exam_2013_2014 male   white                 142         82  </span>
<span class="co">#&gt;  2 exam_2013_2014 female white                 137.        86.7</span>
<span class="co">#&gt;  3 exam_2013_2014 male   hispanic              157.        82  </span>
<span class="co">#&gt;  4 exam_2013_2014 male   white                 127.        66.7</span>
<span class="co">#&gt;  5 exam_2013_2014 female black                 127.        74  </span>
<span class="co">#&gt;  6 exam_2013_2014 female other                 141.        57.3</span>
<span class="co">#&gt;  7 exam_2013_2014 female black                 160         71.3</span>
<span class="co">#&gt;  8 exam_2013_2014 male   white                 109.        53.3</span>
<span class="co">#&gt;  9 exam_2013_2014 female white                 140         82.7</span>
<span class="co">#&gt; 10 exam_2013_2014 female other                 140         50  </span>
<span class="co">#&gt; # ... with 4,402 more rows</span></pre></div>
</div>
<div id="making-the-summary-data" class="section level1">
<h1 class="hasAnchor">
<a href="#making-the-summary-data" class="anchor"></a>Making the summary data</h1>
<p>For each NHANES exam and sex/race/ethnicity group, we would like to compute the mean and standard deviation of BP. We’ll use <code>dplyr</code> for this.</p>
<div class="sourceCode" id="cb4"><pre class="downlit">

<span class="va">nhanes_bp_summary</span> <span class="op">&lt;-</span> <span class="va">nhanes_analysis</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">exam</span>, <span class="va">sex</span>, <span class="va">race_ethnicity</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarize</a></span><span class="op">(</span>
    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>
      .cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">bp_sys_mmhg</span>, <span class="va">bp_dia_mmhg</span><span class="op">)</span>,
      .fns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
        mean <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>,
        sd <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span>
      <span class="op">)</span>
    <span class="op">)</span>
  <span class="op">)</span>
<span class="co">#&gt; `summarise()` regrouping output by 'exam', 'sex' (override with `.groups` argument)</span>

<span class="va">nhanes_bp_summary</span>
<span class="co">#&gt; # A tibble: 30 x 7</span>
<span class="co">#&gt; # Groups:   exam, sex [6]</span>
<span class="co">#&gt;    exam  sex   race_ethnicity bp_sys_mmhg_mean bp_sys_mmhg_sd bp_dia_mmhg_mean</span>
<span class="co">#&gt;    &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                     &lt;dbl&gt;          &lt;dbl&gt;            &lt;dbl&gt;</span>
<span class="co">#&gt;  1 exam~ fema~ asian                      134.           16.1             73.1</span>
<span class="co">#&gt;  2 exam~ fema~ black                      137.           19.8             70.1</span>
<span class="co">#&gt;  3 exam~ fema~ hispanic                   134.           23.1             69.9</span>
<span class="co">#&gt;  4 exam~ fema~ other                      133.           21.2             70.7</span>
<span class="co">#&gt;  5 exam~ fema~ white                      131.           19.5             67.1</span>
<span class="co">#&gt;  6 exam~ male  asian                      134.           14.7             73.2</span>
<span class="co">#&gt;  7 exam~ male  black                      133.           19.0             72.6</span>
<span class="co">#&gt;  8 exam~ male  hispanic                   133            17.2             71.7</span>
<span class="co">#&gt;  9 exam~ male  other                      132.           15.9             72.6</span>
<span class="co">#&gt; 10 exam~ male  white                      129.           20.2             69.6</span>
<span class="co">#&gt; # ... with 20 more rows, and 1 more variable: bp_dia_mmhg_sd &lt;dbl&gt;</span></pre></div>
</div>
<div id="making-the-summary-strings" class="section level1">
<h1 class="hasAnchor">
<a href="#making-the-summary-strings" class="anchor"></a>Making the summary strings</h1>
<p>With our summary data, we can now create the data that will be passed to our table. This is where <code>table.glue</code> comes into the picture.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">

<span class="va">rspec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/round_spec.html">round_spec</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/round_half_up.html">round_half_even</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/round_using_magnitude.html">round_using_magnitude</a></span><span class="op">(</span>
    digits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>,  <span class="fl">1</span>,   <span class="fl">0</span><span class="op">)</span>,
    breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">100</span>, <span class="cn">Inf</span><span class="op">)</span>
  <span class="op">)</span>

<span class="va">nhanes_bp_strings</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="va">nhanes_bp_summary</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">transmute</a></span><span class="op">(</span>
    <span class="va">exam</span>,
    <span class="va">sex</span>, 
    <span class="va">race_ethnicity</span>,
    sbp <span class="op">=</span> <span class="fu"><a href="../reference/table_glue.html">table_glue</a></span><span class="op">(</span><span class="st">"{bp_sys_mmhg_mean} ({bp_sys_mmhg_sd})"</span>, rspec<span class="op">=</span><span class="va">rspec</span><span class="op">)</span>,
    dbp <span class="op">=</span> <span class="fu"><a href="../reference/table_glue.html">table_glue</a></span><span class="op">(</span><span class="st">"{bp_dia_mmhg_mean} ({bp_dia_mmhg_sd})"</span>, rspec<span class="op">=</span><span class="va">rspec</span><span class="op">)</span>
  <span class="op">)</span></pre></div>
</div>
<div id="making-the-table-object" class="section level1">
<h1 class="hasAnchor">
<a href="#making-the-table-object" class="anchor"></a>Making the table object</h1>
<p>Making a table out of <code>nhanes_tbl_strings</code> is fairly straightforward, but does require a fair bit of code to recode variables and label things.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">

<span class="va">nhanes_bp_table</span> <span class="op">&lt;-</span> <span class="va">nhanes_bp_strings</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>
    race_ethnicity <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span>
      <span class="va">race_ethnicity</span>,
      <span class="st">'hispanic'</span> <span class="op">=</span> <span class="st">"Mexican American"</span>,
      <span class="st">'asian'</span> <span class="op">=</span> <span class="st">"Non-Hispanic Asian"</span>,
      <span class="st">'black'</span> <span class="op">=</span> <span class="st">"Non-Hispanic Black"</span>,
      <span class="st">'white'</span> <span class="op">=</span> <span class="st">"Non-Hispanic White"</span>,
      <span class="st">'other'</span> <span class="op">=</span> <span class="st">"Other Race - Including Multi-Racial"</span>
    <span class="op">)</span>,
    sex <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span>
      <span class="va">sex</span>, 
      <span class="st">'female'</span> <span class="op">=</span> <span class="st">'Female survey participants'</span>, 
      <span class="st">'male'</span> <span class="op">=</span> <span class="st">'Male survey participants'</span>
    <span class="op">)</span>,
    exam <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/recode.html">recode</a></span><span class="op">(</span>
      <span class="va">exam</span>,
      <span class="st">'exam_2013_2014'</span> <span class="op">=</span> <span class="st">'2013-2014'</span>,
      <span class="st">'exam_2015_2016'</span> <span class="op">=</span> <span class="st">'2015-2016'</span>,
      <span class="st">'exam_2017_2018'</span> <span class="op">=</span> <span class="st">'2017-2018'</span>
    <span class="op">)</span>
  <span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">'exam'</span>,
              values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'sbp'</span>, <span class="st">'dbp'</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/gt.html">gt</a></span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">'race_ethnicity'</span>, 
     groupname_col <span class="op">=</span> <span class="st">'sex'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/cols_label.html">cols_label</a></span><span class="op">(</span>
    <span class="st">"sbp_2013-2014"</span> <span class="op">=</span> <span class="st">"2013-2014"</span>,
    <span class="st">"sbp_2015-2016"</span> <span class="op">=</span> <span class="st">"2015-2016"</span>,
    <span class="st">"sbp_2017-2018"</span> <span class="op">=</span> <span class="st">"2017-2018"</span>,
    <span class="st">"dbp_2013-2014"</span> <span class="op">=</span> <span class="st">"2013-2014"</span>,
    <span class="st">"dbp_2015-2016"</span> <span class="op">=</span> <span class="st">"2015-2016"</span>,
    <span class="st">"dbp_2017-2018"</span> <span class="op">=</span> <span class="st">"2017-2018"</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/cols_align.html">cols_align</a></span><span class="op">(</span><span class="st">'center'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_stubhead.html">tab_stubhead</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">'Race / ethnicity'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_spanner.html">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">'Systolic BP, mm Hg'</span>,
              columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"sbp_2013-2014"</span>,
                          <span class="st">"sbp_2015-2016"</span>,
                          <span class="st">"sbp_2017-2018"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_spanner.html">tab_spanner</a></span><span class="op">(</span>label <span class="op">=</span> <span class="st">'Diastolic BP, mm Hg'</span>,
              columns <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"dbp_2013-2014"</span>,
                          <span class="st">"dbp_2015-2016"</span>,
                          <span class="st">"dbp_2017-2018"</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/gt/man/tab_header.html">tab_header</a></span><span class="op">(</span>
    title <span class="op">=</span> <span class="st">"Systolic and diastolic blood pressure for female and male participants in the US National Health and Nutrition Examination Survey from 2013 - 2018"</span>, 
    subtitle <span class="op">=</span> <span class="st">"Table values are mean (standard deviation)"</span>
  <span class="op">)</span>

<span class="va">nhanes_bp_table</span></pre></div>
<style>html {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif;
}

#oaypareyvp .gt_table {
  display: table;
  border-collapse: collapse;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#oaypareyvp .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oaypareyvp .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#oaypareyvp .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 0;
  padding-bottom: 4px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#oaypareyvp .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oaypareyvp .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#oaypareyvp .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#oaypareyvp .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#oaypareyvp .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#oaypareyvp .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#oaypareyvp .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#oaypareyvp .gt_group_heading {
  padding: 8px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
}

#oaypareyvp .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#oaypareyvp .gt_from_md > :first-child {
  margin-top: 0;
}

#oaypareyvp .gt_from_md > :last-child {
  margin-bottom: 0;
}

#oaypareyvp .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#oaypareyvp .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 12px;
}

#oaypareyvp .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oaypareyvp .gt_first_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
}

#oaypareyvp .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#oaypareyvp .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#oaypareyvp .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#oaypareyvp .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#oaypareyvp .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oaypareyvp .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding: 4px;
}

#oaypareyvp .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#oaypareyvp .gt_sourcenote {
  font-size: 90%;
  padding: 4px;
}

#oaypareyvp .gt_left {
  text-align: left;
}

#oaypareyvp .gt_center {
  text-align: center;
}

#oaypareyvp .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#oaypareyvp .gt_font_normal {
  font-weight: normal;
}

#oaypareyvp .gt_font_bold {
  font-weight: bold;
}

#oaypareyvp .gt_font_italic {
  font-style: italic;
}

#oaypareyvp .gt_super {
  font-size: 65%;
}

#oaypareyvp .gt_footnote_marks {
  font-style: italic;
  font-size: 65%;
}
</style>
<div id="oaypareyvp" style="overflow-x:auto;overflow-y:auto;width:auto;height:auto;"><table class="table gt_table">
<thead class="gt_header">
<tr>
<th colspan="7" class="gt_heading gt_title gt_font_normal" style>Systolic and diastolic blood pressure for female and male participants in the US National Health and Nutrition Examination Survey from 2013 - 2018</th>
    </tr>
<tr>
<th colspan="7" class="gt_heading gt_subtitle gt_font_normal gt_bottom_border" style>Table values are mean (standard deviation)</th>
    </tr>
</thead>
<thead class="gt_col_headings">
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_left" rowspan="2" colspan="1">Race / ethnicity</th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Systolic BP, mm Hg</span>
      </th>
      <th class="gt_center gt_columns_top_border gt_column_spanner_outer" rowspan="1" colspan="3">
        <span class="gt_column_spanner">Diastolic BP, mm Hg</span>
      </th>
    </tr>
<tr>
<th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2013-2014</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2015-2016</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2017-2018</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2013-2014</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2015-2016</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1">2017-2018</th>
    </tr>
</thead>
<tbody class="gt_table_body">
<tr class="gt_group_heading_row">
<td colspan="7" class="gt_group_heading">Female survey participants</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic Asian</td>
      <td class="gt_row gt_center">134 (16.1)</td>
      <td class="gt_row gt_center">137 (17.9)</td>
      <td class="gt_row gt_center">139 (19.0)</td>
      <td class="gt_row gt_center">73.1 (10.7)</td>
      <td class="gt_row gt_center">72.3 (12.2)</td>
      <td class="gt_row gt_center">74.4 (10.3)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic Black</td>
      <td class="gt_row gt_center">137 (19.8)</td>
      <td class="gt_row gt_center">136 (19.1)</td>
      <td class="gt_row gt_center">141 (22.0)</td>
      <td class="gt_row gt_center">70.1 (13.3)</td>
      <td class="gt_row gt_center">71.0 (15.1)</td>
      <td class="gt_row gt_center">73.9 (12.7)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Mexican American</td>
      <td class="gt_row gt_center">134 (23.1)</td>
      <td class="gt_row gt_center">133 (16.8)</td>
      <td class="gt_row gt_center">142 (19.7)</td>
      <td class="gt_row gt_center">69.9 (13.3)</td>
      <td class="gt_row gt_center">67.7 (10.8)</td>
      <td class="gt_row gt_center">72.4 (11.5)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Other Race - Including Multi-Racial</td>
      <td class="gt_row gt_center">133 (21.2)</td>
      <td class="gt_row gt_center">137 (21.9)</td>
      <td class="gt_row gt_center">139 (21.2)</td>
      <td class="gt_row gt_center">70.7 (11.5)</td>
      <td class="gt_row gt_center">67.3 (12.3)</td>
      <td class="gt_row gt_center">71.3 (13.6)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic White</td>
      <td class="gt_row gt_center">131 (19.5)</td>
      <td class="gt_row gt_center">135 (21.8)</td>
      <td class="gt_row gt_center">137 (21.3)</td>
      <td class="gt_row gt_center">67.1 (11.8)</td>
      <td class="gt_row gt_center">67.9 (11.7)</td>
      <td class="gt_row gt_center">69.1 (15.0)</td>
    </tr>
<tr class="gt_group_heading_row">
<td colspan="7" class="gt_group_heading">Male survey participants</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic Asian</td>
      <td class="gt_row gt_center">134 (14.7)</td>
      <td class="gt_row gt_center">137 (20.4)</td>
      <td class="gt_row gt_center">133 (21.4)</td>
      <td class="gt_row gt_center">73.2 (11.3)</td>
      <td class="gt_row gt_center">71.9 (13.3)</td>
      <td class="gt_row gt_center">74.3 (13.1)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic Black</td>
      <td class="gt_row gt_center">133 (19.0)</td>
      <td class="gt_row gt_center">139 (21.0)</td>
      <td class="gt_row gt_center">137 (20.2)</td>
      <td class="gt_row gt_center">72.6 (12.8)</td>
      <td class="gt_row gt_center">74.1 (13.3)</td>
      <td class="gt_row gt_center">77.6 (12.5)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Mexican American</td>
      <td class="gt_row gt_center">133 (17.2)</td>
      <td class="gt_row gt_center">136 (16.8)</td>
      <td class="gt_row gt_center">134 (19.9)</td>
      <td class="gt_row gt_center">71.7 (12.1)</td>
      <td class="gt_row gt_center">68.9 (12.5)</td>
      <td class="gt_row gt_center">73.2 (11.2)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Other Race - Including Multi-Racial</td>
      <td class="gt_row gt_center">132 (15.9)</td>
      <td class="gt_row gt_center">133 (15.5)</td>
      <td class="gt_row gt_center">133 (19.1)</td>
      <td class="gt_row gt_center">72.6 (11.6)</td>
      <td class="gt_row gt_center">71.3 (13.2)</td>
      <td class="gt_row gt_center">76.9 (12.5)</td>
    </tr>
<tr>
<td class="gt_row gt_left gt_stub">Non-Hispanic White</td>
      <td class="gt_row gt_center">129 (20.2)</td>
      <td class="gt_row gt_center">132 (19.1)</td>
      <td class="gt_row gt_center">133 (18.0)</td>
      <td class="gt_row gt_center">69.6 (13.3)</td>
      <td class="gt_row gt_center">68.6 (12.0)</td>
      <td class="gt_row gt_center">71.4 (11.7)</td>
    </tr>
</tbody>
</table></div>
</div>
<div id="making-the-inline-object" class="section level1">
<h1 class="hasAnchor">
<a href="#making-the-inline-object" class="anchor"></a>Making the inline object</h1>
<p>Now we just need to summarize the table, which can be done using an inline table object. Just like the table, our inline object is created using <code>nhanes_bp_strings</code></p>
<div class="sourceCode" id="cb7"><pre class="downlit">

<span class="va">nhanes_bp_inline</span> <span class="op">&lt;-</span> <span class="va">nhanes_bp_strings</span> <span class="op">%&gt;%</span> 
  <span class="fu"><a href="../reference/as_inline.html">as_inline</a></span><span class="op">(</span>tbl_variables <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'exam'</span>, <span class="st">'sex'</span>, <span class="st">'race_ethnicity'</span><span class="op">)</span>,
            tbl_value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'sbp'</span>, <span class="st">'dbp'</span><span class="op">)</span><span class="op">)</span>

<span class="co"># Now you can freely access any cell in the table</span>
<span class="va">nhanes_bp_inline</span><span class="op">$</span><span class="va">exam_2013_2014</span><span class="op">$</span><span class="va">male</span><span class="op">$</span><span class="va">black</span><span class="op">$</span><span class="va">sbp</span>
<span class="co">#&gt; [1] "133 (19.0)"</span>
<span class="va">nhanes_bp_inline</span><span class="op">$</span><span class="va">exam_2017_2018</span><span class="op">$</span><span class="va">male</span><span class="op">$</span><span class="va">black</span><span class="op">$</span><span class="va">sbp</span> 
<span class="co">#&gt; [1] "137 (20.2)"</span></pre></div>
</div>
<div id="using-the-inline-object" class="section level1">
<h1 class="hasAnchor">
<a href="#using-the-inline-object" class="anchor"></a>Using the inline object</h1>
<p>This part is easy: “Among survey participants who were black and female, the mean (standard deviation) of systolic blood pressure increased from 137 (19.8) in 2013-2014 to 141 (22.0) in 2017-2018.”</p>
<p>But what if you don’t want to report the standard deviations? These are helpful in the table but less so in the text. To get rid of these, you can use the bracket helper functions, e.g., <code><a href="../reference/bracket_drop.html">bracket_drop()</a></code> and <code><a href="../reference/bracket_drop.html">bracket_extract()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">

<span class="co"># Drop the bracket</span>
<span class="fu"><a href="../reference/bracket_drop.html">bracket_drop</a></span><span class="op">(</span><span class="va">nhanes_bp_inline</span><span class="op">$</span><span class="va">exam_2013_2014</span><span class="op">$</span><span class="va">male</span><span class="op">$</span><span class="va">black</span><span class="op">$</span><span class="va">sbp</span><span class="op">)</span>
<span class="co">#&gt; [1] "133"</span>
<span class="co"># Get the bracket</span>
<span class="fu"><a href="../reference/bracket_drop.html">bracket_extract</a></span><span class="op">(</span><span class="va">nhanes_bp_inline</span><span class="op">$</span><span class="va">exam_2017_2018</span><span class="op">$</span><span class="va">male</span><span class="op">$</span><span class="va">black</span><span class="op">$</span><span class="va">sbp</span><span class="op">)</span>
<span class="co">#&gt; [1] "(20.2)"</span></pre></div>
<p>Let’s re-write our sentence more directly: “Among survey participants who were black and female, the mean systolic blood pressure increased from 137 mm Hg in 2013-2014 to 141 mm Hg in 2017-2018.”</p>
</div>
<div id="summary" class="section level1">
<h1 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h1>
<p>This case study has covered three big ideas:</p>
<ol style="list-style-type: decimal">
<li><p>Making summary data</p></li>
<li><p>Making summary strings</p></li>
<li><p>Making the table and inline object</p></li>
</ol>
<p>The workflow covered here is designed to fit almost any table and work with any package that creates tables. Happy tabulating!</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Byron Jaeger.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
